{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./client/js/app.js","webpack:///./client/js/entities/bomb.js","webpack:///./client/js/entities/bone.js","webpack:///./client/js/entities/enemy_player.js","webpack:///./client/js/entities/fire_blast.js","webpack:///./client/js/entities/info.js","webpack:///./client/js/entities/player.js","webpack:///./client/js/entities/spoil.js","webpack:///./client/js/helpers/elements.js","webpack:///./client/js/states/boot.js","webpack:///./client/js/states/menu.js","webpack:///./client/js/states/pending_game.js","webpack:///./client/js/states/play.js","webpack:///./client/js/states/preload.js","webpack:///./client/js/states/select_map.js","webpack:///./client/js/states/win.js","webpack:///./client/js/utils/constants.js","webpack:///./client/js/utils/utils.js"],"names":["config","type","Phaser","AUTO","parent","width","height","pixelArt","audio","noAudio","scale","mode","Scale","NONE","autoCenter","CENTER_BOTH","scene","physics","default","arcade","gravity","y","game","Game","Bomb","id","col","row","add","existing","body","pushable","tween","tweens","targets","to","x","alpha","value","duration","ease","delay","yoyo","repeat","repeatDelay","hold","duraton","anims","create","key","frames","generateFrameNumbers","start","end","frameRate","play","GameObjects","Sprite","Bone","EnemyPlayer","spawn","skin","currentPosition","lastMoveAt","setSize","defineSelf","newPosition","time","now","animateFace","face","diffX","diffY","name","playerText","text","style","font","fill","stroke","strokeThickness","FireBlast","cell","hideOnComplete","addEvent","callback","destroy","bind","callbackScope","loop","Info","player","align","redStyle","bootsIcon","image","speedText","speedLabel","powerIcon","powerText","powerLabel","delayIcon","delayText","delayLabel","deadText","sys","canvas","clientWidth","setOrigin","visible","speed","power","Player","prevPosition","_lastBombTime","positionUpdaterLoop","info","defineKeyboard","socket","registry","get","alive","handleMoves","handleBombs","cursorKeys","input","keyboard","createCursorKeys","velocity","set","animationsArray","left","isDown","push","right","up","down","currentAnimation","stop","space","emit","currentCol","currentRow","Math","floor","showDeadInfo","spoil_type","increaseSpeed","increasePower","increaseDelay","asset","refreshStatistic","Spoil","spoil","Text","Button","callbackContext","overFrame","outFrame","downFrame","upFrame","Input","Gamepad","TextButton","label","console","log","enable","atext","setInteractive","on","onDown","onUp","onOver","setFrame","mycallbackFunction","GameSlots","availableGames","game_slot_asset","game_enter_asset","yOffset","nbGame","availableGame","gameBox","Image","button","game_id","Container","PlayerSlots","max_players","players","asset_empty","asset_player","xOffset","YOffset","i","slotBox","slotName","_player","SpoilNotification","picture","setAlpha","finish","Group","COLOR_PRIMARY","COLOR_LIGHT","COLOR_DARK","MapSlider","selected","selectedLabel","maps","map","component","scrollablePanel","rexUI","scrollMode","background","roundRectangle","panel","child","createPanel","mask","padding","slider","track","thumb","top","bottom","layout","labels","topOnly","getElement","forEach","click","setColor","data","sizer","orientation","item","length","circleMaskImage","maskType","radius","icon","Boot","clientHeight","io","Scene","Menu","slotsWithGame","displayPendingGames","hostGameAction","joinGameAction","PendingGame","slotsWithPlayer","startGameButton","startGameAction","disactivate","leaveGameAction","gameTitle","displayGameInfo","launchGame","current_game","Object","values","activate","Play","currentGame","createMap","createPlayers","setEventHandlers","collider","blockLayer","enemies","bombs","overlap","spoils","onPlayerVsSpoil","blasts","onPlayerVsBlast","update","stopAnimationLoop","tilemap","tileset","addTilesetImage","createLayer","setCollision","layer","properties","collisionTiles","bones","group","setup","onMovePlayer","onPlayerWin","onShowBomb","onDetonateBomb","onSpoilWasPicked","onShowBones","onPlayerDisconnect","spoil_id","remove","blast","becomesDead","player_id","enemy","goTo","getChildren","getTime","bomb_id","blastedCells","destroyed","putTileAt","empty","pickSpoil","winner_skin","children","Preload","load","spritesheet","frameWidth","frameHeight","tilemapTiledJSON","scenePlugin","url","sceneKey","SelectMap","container","img","txt","selectedMap","confirmStageSelection","mapSlider","joinToNewGame","Win","winnerText","returnToMenu","addKey","Keyboard","KeyCodes","ENTER","AVAILABLE_MAPS","TILESET","LAYER","TILE_SIZE","EXPLOSION_TIME","PING","SPEED","POWER","DELAY","INITIAL_SPEED","STEP_SPEED","MAX_SPEED","INITIAL_DELAY","STEP_DELAY","MIN_DELAY","INITIAL_POWER","STEP_POWER","findFrom","entities","entity","findAndDestroyFrom"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./client/js/app.js\");\n","import Boot from './states/boot.js';\r\nimport Preload from './states/preload.js';\r\nimport Menu from './states/menu.js';\r\nimport SelectMap from './states/select_map.js';\r\nimport PendingGame from './states/pending_game.js';\r\nimport Play from './states/play.js';\r\nimport Win from './states/win.js';\r\n\r\nvar config = {\r\n  type: Phaser.AUTO,\r\n  parent: 'phaser-example',\r\n  width: 980,\r\n  height: 630,\r\n  pixelArt: false,\r\n  audio: {\r\n    noAudio: true\r\n  },\r\n  scale: {\r\n    mode: Phaser.Scale.NONE,\r\n    autoCenter: Phaser.Scale.CENTER_BOTH,\r\n  },\r\n  scene: [Boot, Preload, Menu, SelectMap, PendingGame, Play, Win],\r\n  physics: {\r\n    default: \"arcade\",\r\n    arcade: {\r\n      gravity: { y: 0 }\r\n    }\r\n  }\r\n\r\n};\r\n\r\nvar game = new Phaser.Game(config);","import { TILE_SIZE, EXPLOSION_TIME } from '../utils/constants.js';\r\n\r\nexport default class Bomb extends Phaser.GameObjects.Sprite {\r\n\r\n  constructor(game, id, col, row) {\r\n    super(game, (col * TILE_SIZE) + TILE_SIZE / 2, (row * TILE_SIZE) + TILE_SIZE / 2, 'bomb_tileset');\r\n    this.game = game\r\n    this.id = id;\r\n\r\n    this.game.add.existing(this);\r\n    this.game.physics.add.existing(this);\r\n    this.body.pushable = false;\r\n\r\n    this.tween = this.game.tweens.add({\r\n      targets: this,\r\n      scale: { to: { x: 1.2, y: 1.2 } },\r\n      alpha: { value: 0, duration: 5000, ease: 'Power1', delay: 600 },\r\n      ease: 'Sine.inOut',\r\n      yoyo: true,\r\n      repeat: -1,\r\n      repeatDelay: 1000,\r\n      hold: 1000,\r\n      duraton: EXPLOSION_TIME\r\n    });\r\n\r\n    const anims=game.anims;\r\n    anims.create({key:'bomb', frames: anims.generateFrameNumbers('bomb_tileset', { start: 0, end: 13 }),  frameRate:6, repeat: -1});\r\n\r\n    this.anims.play('bomb');\r\n    this.tween.play();\r\n  }\r\n\r\n  update() {\r\n\r\n  }\r\n\r\n}\r\n","import { TILE_SIZE } from '../utils/constants.js';\r\n\r\nexport default class Bone extends Phaser.GameObjects.Sprite {\r\n\r\n  constructor(game, col, row) {\r\n    super(game, col + TILE_SIZE / 2, row  + TILE_SIZE / 2, 'bone_tileset');\r\n    this.game=game;\r\n    this.game.add.existing(this);\r\n  }\r\n\r\n}\r\n","import { TILE_SIZE, PING } from '../utils/constants.js';\r\nimport { Text } from '../helpers/elements.js';\r\n\r\nexport default class EnemyPlayer extends Phaser.GameObjects.Sprite {\r\n\r\n  constructor({ game, id, spawn, skin }) {\r\n    super(game, (spawn.x) + TILE_SIZE / 2, (spawn.y)  + TILE_SIZE / 2, 'bomberman_' + skin);\r\n\r\n    this.game = game\r\n    this.id = id;\r\n\r\n    this.currentPosition = spawn;\r\n    this.lastMoveAt = 0;\r\n    \r\n    this.game.add.existing(this);\r\n    this.game.physics.add.existing(this);\r\n    this.body.pushable = false;\r\n    this.setSize(20, 20);\r\n\r\n    const anims=game.anims;\r\n    anims.create({key:'up', frames: anims.generateFrameNumbers('bomberman_' + skin, { start: 9, end: 11 }),  frameRate:15, repeat: -1});\r\n    anims.create({key:'down', frames: anims.generateFrameNumbers('bomberman_' + skin, { start: 0, end: 2 }),  frameRate:15, repeat: -1});\r\n    anims.create({key:'right', frames: anims.generateFrameNumbers('bomberman_' + skin, { start: 6, end: 8 }),  frameRate:15, repeat: -1});\r\n    anims.create({key:'left', frames: anims.generateFrameNumbers('bomberman_' + skin, { start: 3, end: 5 }),  frameRate:15, repeat: -1});\r\n\r\n\r\n    this.defineSelf(skin)\r\n  }\r\n\r\n  update () {\r\n\r\n  }\r\n\r\n  goTo(newPosition) {\r\n    this.lastMoveAt =  this.game.time.now;\r\n\r\n    this.animateFace(newPosition);\r\n\r\n     this.tween = this.game.tweens.add({\r\n      targets: this,\r\n      x: newPosition.x,\r\n      y: newPosition.y,\r\n      duration: PING\r\n    });\r\n  }\r\n\r\n  animateFace(newPosition) {\r\n    let face = 'down';\r\n    let diffX = newPosition.x - this.currentPosition.x;\r\n    let diffY = newPosition.y - this.currentPosition.y;\r\n\r\n    if (diffX < 0) {\r\n      face = 'left'\r\n    } else if (diffX > 0) {\r\n      face = 'right'\r\n    } else if (diffY < 0) {\r\n      face = 'up'\r\n    } else if (diffY > 0) {\r\n      face = 'down'\r\n    }\r\n\r\n    this.anims.play(face)\r\n    this.currentPosition = newPosition;\r\n  }\r\n\r\n  defineSelf(name) {\r\n    let playerText = new Text({\r\n      game: this.game,\r\n      x: TILE_SIZE / 2,\r\n      y: -10,\r\n      text: name,\r\n      style: {\r\n        font: '14px Areal',\r\n        fill: '#FFFFFF',\r\n          stroke: '#000000',\r\n          strokeThickness: 3\r\n      }\r\n    })\r\n\r\n    this.game.add.existing(playerText);\r\n  }\r\n}\r\n","import { TILE_SIZE } from '../utils/constants.js';\r\n\r\nexport default class FireBlast extends Phaser.GameObjects.Sprite {\r\n\r\n  constructor(game, cell) {\r\n    super(game, (cell.col * TILE_SIZE) + TILE_SIZE / 2, (cell.row * TILE_SIZE) + TILE_SIZE / 2, cell.type, 0);\r\n\r\n    this.game = game\r\n\r\n    const anims=game.anims;\r\n    anims.create({key:'blast', frames: anims.generateFrameNumbers(cell.type, { start: 0, end: 4 }),  frameRate:15, repeat: -1, hideOnComplete:false});\r\n    this.anims.play('blast');\r\n\r\n    //this.game.physics.arcade.enable(this);\r\n    this.game.add.existing(this);\r\n    this.game.physics.add.existing(this);\r\n\r\n    this.game.time.addEvent({\r\n      delay: 100,                // ms\r\n      callback: this.destroy.bind(this),\r\n      callbackScope: this,\r\n      loop: false\r\n    });\r\n\r\n  }\r\n\r\n}\r\n","import { TILE_SIZE } from '../utils/constants.js';\r\n\r\nexport default class Info {\r\n\r\n  constructor({ game, player }) {\r\n    this.game = game;\r\n    this.player = player;\r\n\r\n    this.style    = { font: '14px Arial', fill: '#ffffff', align: 'left' }\r\n    this.redStyle = { font: '30px Arial', fill: '#ff0044', align: 'center' };\r\n\r\n    let bootsIcon  = this.game.add.image(TILE_SIZE*2, TILE_SIZE / 2, 'placeholder_speed');\r\n    this.speedText = this.game.add.text(TILE_SIZE*2, TILE_SIZE / 4, this.speedLabel(), this.style);\r\n    this.game.add.existing(bootsIcon);\r\n    this.game.add.existing(this.speedText);\r\n\r\n    let powerIcon  = this.game.add.image(TILE_SIZE*5, TILE_SIZE / 2, 'placeholder_power');\r\n    this.powerText = this.game.add.text(TILE_SIZE*5, TILE_SIZE / 4, this.powerLabel(), this.style);\r\n    this.game.add.existing(powerIcon);\r\n    this.game.add.existing(this.powerText);\r\n\r\n    let delayIcon  = this.game.add.image(TILE_SIZE*8, TILE_SIZE / 2, 'placeholder_time');\r\n    this.delayText = this.game.add.text(TILE_SIZE*8, TILE_SIZE / 4, this.delayLabel(), this.style);\r\n    this.game.add.existing(delayIcon);\r\n    this.game.add.existing(this.delayText);\r\n\r\n    this.deadText = this.game.add.text(this.game.sys.canvas.clientWidth/2, this.game.sys.canvas.clientWidth/2 - 30, 'You died :(', this.redStyle);\r\n    this.deadText.setOrigin(0.5,0.5);\r\n    this.deadText.visible = false\r\n  }\r\n\r\n  refreshStatistic() {\r\n    this.speedText.text = this.speedLabel();\r\n    this.powerText.text = this.powerLabel();\r\n    this.delayText.text = this.delayLabel();\r\n  }\r\n\r\n  showDeadInfo() {\r\n    this.deadText.visible = true\r\n  }\r\n\r\n  speedLabel() {\r\n    return this.player.speed\r\n  }\r\n\r\n  powerLabel() {\r\n    return `x ${this.player.power}`\r\n  }\r\n\r\n  delayLabel() {\r\n    return `${this.player.delay / 1000} sec.`\r\n  }\r\n}\r\n","import {\r\n  PING, TILE_SIZE, MAX_SPEED, STEP_SPEED, INITIAL_SPEED, SPEED, POWER, DELAY,\r\n  MIN_DELAY, STEP_DELAY, INITIAL_DELAY, INITIAL_POWER, STEP_POWER\r\n} from '../utils/constants.js';\r\n\r\nimport Info from './info.js';\r\nimport { SpoilNotification, Text } from '../helpers/elements.js';\r\n\r\nexport default class Player extends Phaser.GameObjects.Sprite {\r\n\r\n  constructor({ game, id, spawn, skin }) {\r\n    super(game, (spawn.x) + TILE_SIZE / 2, (spawn.y)  + TILE_SIZE / 2, 'bomberman_' + skin);\r\n\r\n    this.game = game;\r\n    this.id = id;\r\n\r\n    this.prevPosition = { x: spawn.x, y: spawn.y };\r\n\r\n    this.delay = INITIAL_DELAY;\r\n    this.power = INITIAL_POWER;\r\n    this.speed = INITIAL_SPEED;\r\n    this._lastBombTime = 0;\r\n\r\n    this.game.add.existing(this);\r\n    this.game.physics.add.existing(this);\r\n    this.body.pushable = false;\r\n\r\n    this.setSize(20, 20);\r\n    this.game.time.addEvent({\r\n      delay: PING,                // ms\r\n      callback: this.positionUpdaterLoop.bind(this),\r\n      callbackScope: this,\r\n      loop: true\r\n    });\r\n\r\n    const anims=game.anims;\r\n    anims.create({key:'up', frames: anims.generateFrameNumbers('bomberman_' + skin, { start: 9, end: 11 }),  frameRate:15, repeat: -1});\r\n    anims.create({key:'down', frames: anims.generateFrameNumbers('bomberman_' + skin, { start: 0, end: 2 }),  frameRate:15, repeat: -1});\r\n    anims.create({key:'right', frames: anims.generateFrameNumbers('bomberman_' + skin, { start: 6, end: 8 }),  frameRate:15, repeat: -1});\r\n    anims.create({key:'left', frames: anims.generateFrameNumbers('bomberman_' + skin, { start: 3, end: 5 }),  frameRate:15, repeat: -1});\r\n\r\n    this.info = new Info({ game: this.game, player: this });\r\n\r\n    this.defineKeyboard()\r\n    this.defineSelf(skin)\r\n    this.socket=this.game.registry.get('socketIO');\r\n    this.alive=true;\r\n  }\r\n\r\n  update() {\r\n    if (this.alive) {\r\n      this.handleMoves()\r\n      this.handleBombs()\r\n    }\r\n\r\n  }\r\n\r\n  defineKeyboard() {\r\n    this.cursorKeys  = this.game.input.keyboard.createCursorKeys();\r\n  }\r\n\r\n  handleMoves() {\r\n    this.body.velocity.set(0);\r\n    let animationsArray = []\r\n\r\n    if (this.cursorKeys.left.isDown){\r\n      this.body.velocity.x = -this.speed;\r\n      animationsArray.push('left')\r\n    } else if (this.cursorKeys.right.isDown) {\r\n      this.body.velocity.x = this.speed;\r\n      animationsArray.push('right')\r\n    }\r\n\r\n    if (this.cursorKeys.up.isDown) {\r\n      this.body.velocity.y = -this.speed;\r\n      animationsArray.push('up')\r\n    } else if (this.cursorKeys.down.isDown) {\r\n      this.body.velocity.y = this.speed;\r\n      animationsArray.push('down')\r\n    }\r\n\r\n    let currentAnimation = animationsArray[0]\r\n    if (currentAnimation){\r\n      this.anims.play(currentAnimation)\r\n      return\r\n    }\r\n\r\n    this.anims.stop();\r\n  }\r\n\r\n  handleBombs() {\r\n    if (this.cursorKeys.space.isDown) {\r\n      let now = this.game.time.now;\r\n\r\n      if (now > this._lastBombTime) {\r\n        this._lastBombTime = now + this.delay;\r\n\r\n        this.socket.emit('create bomb', { col: this.currentCol(), row: this.currentRow() });\r\n      }\r\n    }\r\n  }\r\n\r\n  currentCol() {\r\n    return Math.floor(this.body.x / TILE_SIZE)\r\n  }\r\n\r\n  currentRow() {\r\n    return Math.floor(this.body.y / TILE_SIZE)\r\n  }\r\n\r\n  positionUpdaterLoop() {\r\n    let newPosition = { x: this.x, y: this.y }\r\n\r\n    if (this.prevPosition.x !== newPosition.x || this.prevPosition.y !== newPosition.y) {\r\n      this.socket.emit('update player position', newPosition);\r\n      this.prevPosition = newPosition;\r\n    }\r\n  }\r\n\r\n  becomesDead() {\r\n    this.alive=false;\r\n    this.info.showDeadInfo()\r\n    this.destroy();\r\n  }\r\n\r\n  pickSpoil( spoil_type ){\r\n    if ( spoil_type === SPEED ){ this.increaseSpeed() }\r\n    if ( spoil_type === POWER ){ this.increasePower() }\r\n    if ( spoil_type === DELAY ){ this.increaseDelay() }\r\n  }\r\n\r\n  increaseSpeed(){\r\n    let asset = 'speed_up_no_bonus'\r\n\r\n    if (this.speed < MAX_SPEED) {\r\n      this.speed = this.speed + STEP_SPEED;\r\n      this.info.refreshStatistic();\r\n      asset = 'speed_up_bonus'\r\n    }\r\n\r\n    new SpoilNotification({ game: this.game, asset: asset, x: this.x, y: this.y })\r\n  }\r\n\r\n  increaseDelay(){\r\n    let asset = 'delay_up_no_bonus'\r\n\r\n    if (this.delay > MIN_DELAY){\r\n      this.delay -= STEP_DELAY;\r\n      this.info.refreshStatistic();\r\n      asset = 'delay_up_bonus'\r\n    }\r\n\r\n    new SpoilNotification({ game: this.game, asset: asset, x: this.x, y: this.y })\r\n  }\r\n\r\n  increasePower(){\r\n    let asset = 'power_up_bonus'\r\n\r\n    this.power += STEP_POWER;\r\n    this.info.refreshStatistic();\r\n\r\n    new SpoilNotification({ game: this.game, asset: asset, x: this.x, y: this.y })\r\n  }\r\n\r\n  defineSelf(name) {\r\n    let playerText = new Text({\r\n      game: this.game,\r\n      x: TILE_SIZE / 2,\r\n      y: -10,\r\n      text: `\\u272E ${name} \\u272E`,\r\n      style: {\r\n        font: '15px Areal',\r\n        fill: '#FFFFFF',\r\n          stroke: '#000000',\r\n          strokeThickness: 3\r\n      }\r\n    })\r\n\r\n    this.game.add.existing(playerText);\r\n  }\r\n}\r\n","import { SPEED, POWER, DELAY, TILE_SIZE } from '../utils/constants.js';\r\n\r\nexport default class Spoil extends Phaser.GameObjects.Sprite {\r\n\r\n  constructor(game, spoil) {\r\n\r\n    let spoil_type;\r\n    if (spoil.spoil_type === DELAY) {\r\n      spoil_type = 0\r\n    }\r\n    if (spoil.spoil_type === POWER) {\r\n      spoil_type =  1\r\n    }\r\n    if (spoil.spoil_type === SPEED) {\r\n      spoil_type = 2\r\n    }\r\n\r\n    super(game, (spoil.col * TILE_SIZE)+ TILE_SIZE / 2, (spoil.row * TILE_SIZE)+ TILE_SIZE / 2, 'spoil_tileset', spoil_type);\r\n\r\n    this.id = spoil.id\r\n\r\n    game.add.existing(this);\r\n    game.physics.add.existing(this);\r\n  }\r\n\r\n}\r\n","export class Text extends Phaser.GameObjects.Text {\r\n\r\n  constructor({ game: scene, x, y, text, style }) {\r\n    super(scene, x, y, text, style);\r\n    this.setOrigin(0.5, 0.5);\r\n\r\n    scene.add.existing(this);\r\n  }\r\n\r\n}\r\n\r\nexport class Button extends Phaser.Input.Gamepad.Button {\r\n\r\n  constructor({ game, x, y, asset, callback, callbackContext, overFrame, outFrame, downFrame, upFrame }) {\r\n    super(game, x, y, asset, callback, callbackContext, overFrame, outFrame, downFrame, upFrame);\r\n    this.setOrigin(0.5, 0.5);\r\n\r\n    game.add.existing(this);\r\n  }\r\n\r\n}\r\n\r\nexport class TextButton extends Phaser.GameObjects.Sprite {\r\n  constructor({ game, x, y, asset, callback, callbackContext, upFrame, outFrame, overFrame, downFrame, label, style }) {\r\n\r\n    //check if config contains a scene\r\n    if (!game) {\r\n      console.log('missing scene');\r\n      return;\r\n    }\r\n    //check if config contains a key\r\n    if (!asset) {\r\n      console.log(\"missing key!\");\r\n      return;\r\n    }\r\n    //if there is no up property assume 0\r\n    if (!upFrame) {\r\n      upFrame = 0;\r\n    }\r\n    //if there is no down in config use up\r\n    if (!downFrame) {\r\n      downFrame = upFrame;\r\n    }\r\n    //if there is no over in config use up\r\n    if (!overFrame) {\r\n      overFrame = upFrame;\r\n    }\r\n    //call the constructor of the parent\r\n    //set at 0,0 in case there is no x and y\r\n    //in parameter\r\n    super(game, 0, 0, asset, upFrame);\r\n\r\n    //make a class level reference to the config\r\n    this.scene = game;\r\n    this.asset = asset;\r\n    this.callback = callback;\r\n    this.callbackContext = callbackContext;\r\n    this.upFrame = upFrame;\r\n    this.outFrame = outFrame;\r\n    this.overFrame = overFrame;\r\n    this.downFrame = downFrame;\r\n    this.enable = true;\r\n\r\n    //if there is an x assign it\r\n    if (x) {\r\n      this.x = x;\r\n    }\r\n    //if there is an x assign it\r\n    if (y) {\r\n      this.y = y;\r\n    }\r\n\r\n    this.atext = new Phaser.GameObjects.Text(game, x, y, label, style);\r\n    this.atext.setOrigin(0.5, 0.5);\r\n\r\n    //add this to the scene\r\n    game.add.existing(this);\r\n    game.add.existing(this.atext);\r\n    //\r\n    //make interactive and set listeners\r\n    this.setInteractive();\r\n    this.on('pointerdown', this.onDown, this);\r\n    this.on('pointerup', this.onUp, this);\r\n    this.on('pointerover', this.onOver, this);\r\n    this.on('pointerout', this.onUp, this);\r\n  }\r\n\r\n  activate() {\r\n    this.setFrame(this.downFrame);\r\n    this.enable = true;\r\n    this.visible  = true;\r\n    this.atext.visible  = true;\r\n  }\r\n\r\n  disactivate() {\r\n    this.setFrame(this.outFrame);\r\n    this.enable = false;\r\n    this.visible  = false;\r\n    this.atext.visible  = false;\r\n  }\r\n\r\n  onDown() {\r\n    if (this.enable == false) return;\r\n\r\n    this.setFrame(this.downFrame);\r\n    let mycallbackFunction = this.callback.bind(this.callbackContext);\r\n    mycallbackFunction();\r\n  }\r\n\r\n  onOver() {\r\n    if (this.enable == false) return;\r\n    this.setFrame(this.overFrame);\r\n  }\r\n\r\n  onUp() {\r\n    if (this.enable == false) return;\r\n    this.setFrame(this.upFrame);\r\n  }\r\n  onOut() {\r\n    if (this.enable == false) return;\r\n    this.setFrame(this.outFrame);\r\n  }\r\n}\r\n\r\nexport class GameSlots extends Phaser.GameObjects.Container {\r\n\r\n  constructor({ game, availableGames, callback, callbackContext, x, y, style }) {\r\n    super(game);\r\n\r\n    let game_slot_asset = 'slot_backdrop'\r\n    let game_enter_asset = 'list_icon'\r\n\r\n    let yOffset = y;\r\n    let nbGame=0;\r\n\r\n    for (let availableGame of availableGames) {\r\n      let gameBox = new Phaser.GameObjects.Image(game, x+220, yOffset-5, game_slot_asset);\r\n      let button = new TextButton({\r\n        game: game,\r\n        x: x+377,\r\n        y: yOffset-6, \r\n        asset: game_enter_asset,\r\n        callback: callback.bind(callbackContext, { game_id: availableGame.id }), \r\n        callbackContext: null, \r\n        upFrame: 0, \r\n        overFrame: 1,\r\n        downFrame: 2,\r\n        outFrame: 3,\r\n        label: ''});\r\n      let text = new Phaser.GameObjects.Text(game, x+30, yOffset-28, `Join Game: ${availableGame.name}`, style);\r\n\r\n      this.add(gameBox);\r\n      this.add(button);\r\n      this.add(text);\r\n      game.add.existing(gameBox);\r\n      game.add.existing(button);\r\n      game.add.existing(text);\r\n\r\n      yOffset += 105;\r\n      nbGame++;\r\n      if (nbGame>=3) break;\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n  }\r\n}\r\n\r\nexport class PlayerSlots extends Phaser.GameObjects.Container {\r\n\r\n  constructor({ game, max_players, players, x, y, asset_empty, asset_player, style }) {\r\n    super(game);\r\n\r\n    let xOffset = x;\r\n    let YOffset = y;\r\n\r\n    for (let i = 0; i < max_players; i++) {\r\n      let slotBox\r\n      let slotName\r\n      let _player = players[i]\r\n\r\n      if (_player) {\r\n        slotBox = new Phaser.GameObjects.Image(game, xOffset, YOffset, asset_player + _player.skin)\r\n        slotName = new Phaser.GameObjects.Text(game, xOffset, YOffset-90 , _player.skin, style);\r\n        slotName.setOrigin(0.5, 0);\r\n        this.add(slotBox);\r\n        this.add(slotName);\r\n      } else {\r\n        slotBox = new Phaser.GameObjects.Image(game, xOffset, YOffset, asset_empty)\r\n        this.add(slotBox);\r\n      }\r\n      xOffset += 170;\r\n      if (i==2) {\r\n        xOffset = x\r\n        YOffset=YOffset+ slotBox.height +10;\r\n      }\r\n    }\r\n    game.add.existing(this);\r\n  }\r\n\r\n}\r\n\r\nexport class SpoilNotification extends Phaser.GameObjects.Group {\r\n\r\n  constructor({ game, asset, x, y }) {\r\n    super(game)\r\n\r\n    this.picture = game.add.image(x, y - 20, asset).setAlpha(1);\r\n    this.picture.setOrigin(0.5,0.5);\r\n\r\n    this.add(this.picture);\r\n\r\n    this.tween = game.tweens.add({\r\n      targets: this.picture,\r\n      y: this.picture.y - 25,\r\n      alpha: { value: 0, duration: 1000, ease: 'Power1', delay: 600 },\r\n      duration: 600\r\n    });\r\n    this.tween.on('complete', this.finish.bind(this));\r\n  }\r\n\r\n  finish() {\r\n    console.log('SpoilNotification destroyed');\r\n    this.picture.destroy();\r\n    this.destroy();\r\n  }\r\n}\r\n\r\nconst COLOR_PRIMARY = 0x4e342e;\r\nconst COLOR_LIGHT = 0x7b5e57;\r\nconst COLOR_DARK = 0x260e04;\r\n\r\n/**\r\n * Create a Graphic Slider to select a map\r\n * @export\r\n * @class MapSlider\r\n * @extends Phaser.GameObjects.Group\r\n */\r\nexport class MapSlider extends Phaser.GameObjects.Group {\r\n\r\n  /**\r\n   * Creates an instance of MapSlider.\r\n   * @param  {any} { scene, x, y } \r\n   * @memberof MapSlider\r\n   */\r\n  constructor({ scene, x, y }) {\r\n    super(scene)\r\n\r\n    this.selected=null;\r\n    this.selectedLabel=null;\r\n\r\n    this.config = {\r\n      name: 'Options',\r\n      maps: [\r\n        { name: 'Hot', map: 'hot_map', component: 'hot_map_preview_mini' },\r\n        { name: 'Cold', map: 'cold_map', component: 'cold_map_preview_mini' },\r\n      ]\r\n    };\r\n\r\n    this.scrollablePanel = scene.rexUI.add.scrollablePanel({\r\n      x: x,\r\n      y: y,\r\n      width: 500,\r\n      height: 300,\r\n      scrollMode: 1,\r\n      background: scene.rexUI.add.roundRectangle(0, 0, 2, 2, 10, COLOR_PRIMARY),\r\n      panel: {\r\n        child: this.createPanel(scene, this.config),\r\n        mask: { padding: 1},\r\n      },\r\n      slider: {\r\n        track: scene.rexUI.add.roundRectangle(0, 0, 20, 10, 10, COLOR_DARK),\r\n        thumb: scene.rexUI.add.roundRectangle(0, 0, 0, 0, 13, COLOR_LIGHT),\r\n      },\r\n      space: { left: 10, right: 10, top: 10, bottom: 10, panel: 10 }\r\n    }).layout();\r\n    //.layout().drawBounds(scene.add.graphics(), 0xff0000);\r\n\r\n    var labels = [];\r\n    scene.input.topOnly = false;\r\n    labels.push(...(this.scrollablePanel).getElement('#maps.items', true));\r\n    labels.forEach(function (label) {\r\n      if (!label) {return; }\r\n      var click = scene.rexUI.add.click(label,{  }).on('click', function () {\r\n        if (this.selectedLabel!=null && !this.selectedLabel){\r\n          this.selectedLabel.getElement('text').setColor('#ffffff');\r\n        }\r\n        label.getElement('text').setColor('red');\r\n        console.log(\"hello: \"+label.getElement('icon').name);\r\n        this.selectedLabel=label;\r\n        this.selected=label.getElement('icon').name;\r\n      });\r\n    })\r\n\r\n  }\r\n\r\n  /**\r\n   * Create \r\n   * @param  {any} scene \r\n   * @param  {any} data \r\n   * @return \r\n   * @memberof MapSlider\r\n   */\r\n  createPanel(scene, data) {\r\n    var sizer = scene.rexUI.add.sizer({ orientation: 'x', space: { item: 10 } ,name:'maps'});\r\n    //scene.rexUI.setChildrenInteractive(sizer);\r\n    for (var i = 0; i < (data['maps']).length; i++) {\r\n      var map= scene.rexUI.add.circleMaskImage(0, 0, (data['maps'])[i].component, { maskType: 'roundRectangle', radius: 10  })\r\n      const COLOR_LIGHT = 0x7b5e57;\r\n      map.name=(data['maps'])[i].map;\r\n      var label = scene.rexUI.add.label({\r\n        orientation: 'y',\r\n        icon: map,\r\n        text: scene.add.text(0, 0, map.name),\r\n        space: { icon: 3 }\r\n      });\r\n      sizer.add(label,{key :map.name});\r\n    }\r\n    return sizer;\r\n  }\r\n\r\n  onDown() {\r\n    console.log(\"hello\");\r\n  }\r\n\r\n  destroy(){\r\n    this.scrollablePanel.destroy();\r\n  }\r\n\r\n}\r\n","import { Text } from '../helpers/elements.js';\r\n\r\nexport class Boot extends Phaser.Scene {\r\n\r\n  create() {\r\n    // Make the game keep reacting to messages from the server even when the game window doesnt have focus.\r\n    // The game pauses when I open a new tab in the same window, but does not pause when I focus on another application\r\n\r\n    new Text({\r\n      game: this,\r\n      x: this.sys.canvas.clientWidth/2,\r\n      y: this.sys.canvas.clientHeight/2,\r\n      text: 'Loading...',\r\n      style: {\r\n        font: '30px Areal',\r\n        fill: '#FFFFFF',\r\n        align: 'center'\r\n      }\r\n    })\r\n  }\r\n\r\n  create() {\r\n    console.log('Start Boot.create');\r\n    this.registry.set('socketIO', io());\r\n    this.scene.start('Preload');\r\n    console.log('End  Boot.create');\r\n  }\r\n\r\n}\r\n\r\nexport default Boot;\r\n","import { Text, TextButton, GameSlots } from '../helpers/elements.js';\r\n\r\nclass Menu extends Phaser.Scene {\r\n\r\n  constructor () {\r\n      super('Menu');\r\n  }\r\n\r\n  init(data) {\r\n    this.slotsWithGame = null;\r\n    this.socket=this.registry.get('socketIO');\r\n\r\n    this.socket.on('display pending games', this.displayPendingGames.bind(this));\r\n  }\r\n\r\n  create() {\r\n    let background = this.add.image(this.sys.canvas.clientWidth/2, this.sys.canvas.clientHeight/2, 'main_menu');\r\n    background.setOrigin(0.5,0.5);\r\n\r\n\r\n    new Text({\r\n      game: this,\r\n      x: this.sys.canvas.clientWidth/2,\r\n      y: this.sys.canvas.clientHeight/2 - 215,\r\n      text: 'Main Menu',\r\n      style: {\r\n        font: '35px Areal',\r\n        fill: '#9ec0ba',\r\n        stroke: '#7f9995',\r\n        strokeThickness: 3\r\n      }\r\n    })\r\n\r\n    var button = new TextButton({\r\n      game: this,\r\n      x: this.sys.canvas.clientWidth/2,\r\n      y: this.sys.canvas.clientHeight/2 + 195,\r\n      asset:'buttons',\r\n      callback: this.hostGameAction,\r\n      callbackContext: this,\r\n      upFrame: 0,\r\n      overFrame:1,\r\n      downFrame:2,\r\n      outFrame:3,\r\n      label: 'New Game',\r\n      style: {\r\n        font: '20px Areal',\r\n        fill: '#000000'\r\n      }\r\n    });\r\n    this.socket.emit('enter lobby', this.displayPendingGames.bind(this));\r\n\r\n  }\r\n\r\n  update() {\r\n\r\n\r\n  \r\n  }\r\n\r\n  hostGameAction() {\r\n    this.socket.emit('leave lobby');\r\n    this.scene.start('SelectMap');\r\n  }\r\n\r\n  displayPendingGames(availableGames) {\r\n    // NOTE: That is not optimal way to preview slots,\r\n    //       we should implement AddSlotToGroup, RemoveSlotFromGroup\r\n\r\n    // I triying to care about readability, not about performance.\r\n    if (this.slotsWithGame) {\r\n      this.slotsWithGame.destroy()\r\n    }\r\n\r\n    this.slotsWithGame = new GameSlots({\r\n      game: this,\r\n      availableGames: availableGames,\r\n      callback: this.joinGameAction,\r\n      callbackContext: this,\r\n      x: this.sys.canvas.clientWidth/2 - 220,\r\n      y: this.sys.canvas.clientHeight/2 -100,\r\n      style: {\r\n        font: '35px Areal',\r\n        fill: '#efefef',\r\n        stroke: '#ae743a',\r\n        strokeThickness: 3\r\n      }\r\n    });\r\n  }\r\n\r\n  joinGameAction(game_id) {\r\n    this.socket.emit('leave lobby');\r\n    console.log('Selected game: '+game_id.game_id);\r\n    this.scene.start('PendingGame', game_id);\r\n  }\r\n}\r\n\r\nexport default Menu;\r\n","import { Text, TextButton, PlayerSlots } from '../helpers/elements.js';\r\n\r\nclass PendingGame extends Phaser.Scene {\r\n\r\n  constructor () {\r\n    super('PendingGame');\r\n  }\r\n\r\n  init({ game_id }) {\r\n    this.socket=this.registry.get('socketIO');\r\n    this.slotsWithPlayer = null;\r\n\r\n    this.game_id = game_id;\r\n\r\n    this.socket.emit('enter pending game', { game_id: this.game_id });\r\n  }\r\n\r\n  create() {\r\n    let background = this.add.image(this.sys.canvas.clientWidth/2, this.sys.canvas.clientHeight/2, 'main_menu');\r\n    background.setOrigin(0.5,0.5);\r\n\r\n    new Text({\r\n      game: this,\r\n      x: this.sys.canvas.clientWidth/2,\r\n      y: this.sys.canvas.clientHeight/2 - 215,\r\n      text: '',\r\n      style: {\r\n        font: '35px Areal',\r\n        fill: '#9ec0ba',\r\n        stroke: '#7f9995',\r\n        strokeThickness: 3\r\n      }\r\n    })\r\n\r\n    this.startGameButton = new TextButton({\r\n      game: this,\r\n      x: this.sys.canvas.clientWidth/2 + 105,\r\n      y: this.sys.canvas.clientHeight/2 + 195,\r\n      asset: 'buttons',\r\n      callback: this.startGameAction,\r\n      callbackContext: this,\r\n      overFrame: 1,\r\n      outFrame: 0,\r\n      downFrame: 2,\r\n      upFrame: 0,\r\n      label: 'Start Game',\r\n      style: {\r\n        font: '20px Areal',\r\n        fill: '#000000'\r\n      }\r\n    });\r\n    this.startGameButton.disactivate();\r\n\r\n    new TextButton({\r\n      game: this,\r\n      x: this.sys.canvas.clientWidth/2 - 105,\r\n      y: this.sys.canvas.clientHeight/2 + 195,\r\n      asset: 'buttons',\r\n      callback: this.leaveGameAction,\r\n      callbackContext: this,\r\n      overFrame: 1,\r\n      outFrame: 0,\r\n      downFrame: 2,\r\n      upFrame: 0,\r\n      label: 'Leave Game',\r\n      style: {\r\n        font: '20px Areal',\r\n        fill: '#000000'\r\n      }\r\n    });\r\n\r\n    this.gameTitle = new Text({\r\n      game: this,\r\n      x: this.sys.canvas.clientWidth/2,\r\n      y: this.sys.canvas.clientHeight/2 - 215,\r\n      text: '',\r\n      style: {\r\n        font: '35px Areal',\r\n        fill: '#9ec0ba',\r\n        stroke: '#6f7975',\r\n        strokeThickness: 3\r\n      }\r\n    })\r\n\r\n    this.socket.on('update game', this.displayGameInfo.bind(this));\r\n    this.socket.on('launch game', this.launchGame.bind(this));\r\n\r\n  }\r\n\r\n  displayGameInfo({ current_game }) {\r\n    let players = Object.values(current_game.players);\r\n\r\n    this.gameTitle.text = current_game.name\r\n\r\n    if (this.slotsWithPlayer) {\r\n      this.slotsWithPlayer.destroy()\r\n    }\r\n\r\n    if(players.length > 1) {\r\n      this.startGameButton.activate();\r\n    } else {\r\n      this.startGameButton.disactivate();\r\n    }\r\n\r\n    this.slotsWithPlayer = new PlayerSlots({\r\n      game: this,\r\n      max_players: current_game.max_players,\r\n      players: players,\r\n      x: this.sys.canvas.clientWidth/2 - 174,\r\n      y: this.sys.canvas.clientHeight/2 - 81,\r\n      asset_empty: 'bomberman_head_blank',\r\n      asset_player: 'bomberman_head_',\r\n      style: {\r\n        font: '20px Areal',\r\n        fill: '#48291c'\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n  leaveGameAction() {\r\n    this.socket.emit('leave pending game');\r\n\r\n    this.scene.start('Menu');\r\n  }\r\n\r\n  startGameAction() {\r\n    this.socket.emit('start game');\r\n  }\r\n\r\n  launchGame(game) {\r\n    this.scene.start('Play', game);\r\n  }\r\n}\r\n\r\nexport default PendingGame;\r\n","import { findFrom, findAndDestroyFrom } from '../utils/utils.js';\r\nimport { TILESET, LAYER } from '../utils/constants.js';\r\n\r\nimport Player from '../entities/player.js';\r\nimport EnemyPlayer from '../entities/enemy_player.js';\r\nimport Bomb from '../entities/bomb.js';\r\nimport Spoil from '../entities/spoil.js';\r\nimport FireBlast from '../entities/fire_blast.js';\r\nimport Bone from '../entities/bone.js';\r\n\r\nclass Play extends Phaser.Scene {\r\n\r\n  constructor () {\r\n    super('Play');\r\n  }\r\n\r\n  init(game) {\r\n    this.socket=this.registry.get('socketIO');\r\n    this.currentGame = game\r\n  }\r\n\r\n  create() {\r\n    this.createMap();\r\n    this.createPlayers();\r\n    this.setEventHandlers();\r\n    //this.game.time.events.loop(400 , this.stopAnimationLoop.bind(this));\r\n  }\r\n\r\n  update() {\r\n    this.physics.add.collider(this.player, this.blockLayer);\r\n    this.physics.add.collider(this.player, this.enemies);\r\n    this.physics.add.collider(this.player, this.bombs);\r\n\r\n    this.physics.overlap(this.player, this.spoils, this.onPlayerVsSpoil, null, this);\r\n    this.physics.overlap(this.player, this.blasts, this.onPlayerVsBlast, null, this);\r\n    this.player.update();\r\n    this.stopAnimationLoop();\r\n  }\r\n\r\n  createMap() {\r\n    this.map = this.add.tilemap('hot_map');\r\n\r\n    const tileset=this.map.addTilesetImage(TILESET,null, 35, 35, 0, 0);\r\n    this.blockLayer = this.map.createLayer(LAYER, tileset);\r\n\r\n    this.map.setCollision(this.blockLayer.layer.properties.collisionTiles)\r\n\r\n    this.player  = null;\r\n    this.bones   = this.add.group({key: 'bones'});\r\n    this.bombs   = this.add.group({key: 'bombs'});\r\n    this.spoils  = this.add.group({key: 'spoils'});\r\n    this.blasts  = this.add.group({key: 'blasts'});\r\n    this.enemies = this.add.group({key: 'enemies'});\r\n  }\r\n\r\n  createPlayers() {\r\n    for (let player of Object.values(this.currentGame.players)) {\r\n      let setup = {\r\n        game:   this,\r\n        id:     player.id,\r\n        spawn:  player.spawn,\r\n        skin:   player.skin\r\n      }\r\n\r\n      if (player.id === this.socket.id) {\r\n        this.player = new Player(setup);\r\n      } else {\r\n        this.enemies.add(new EnemyPlayer(setup))\r\n      }\r\n    }\r\n  }\r\n\r\n  setEventHandlers() {\r\n    this.socket.on('move player', this.onMovePlayer.bind(this));\r\n    this.socket.on('player win', this.onPlayerWin.bind(this));\r\n    this.socket.on('show bomb', this.onShowBomb.bind(this));\r\n    this.socket.on('detonate bomb', this.onDetonateBomb.bind(this));\r\n    this.socket.on('spoil was picked', this.onSpoilWasPicked.bind(this));\r\n    this.socket.on('show bones', this.onShowBones.bind(this));\r\n    this.socket.on('player disconnect', this.onPlayerDisconnect.bind(this));\r\n  }\r\n\r\n  onPlayerVsSpoil(player, spoil) {\r\n    this.socket.emit('pick up spoil', { spoil_id: spoil.id });\r\n    this.spoils.remove(spoil,true,true);\r\n  }\r\n\r\n  onPlayerVsBlast(player, blast) {\r\n    if (player.alive) {\r\n      this.socket.emit('player died', { col: player.currentCol(), row: player.currentRow() });\r\n      player.becomesDead()\r\n    }\r\n  }\r\n\r\n  onMovePlayer({ player_id, x, y }) {\r\n    let enemy = findFrom(player_id, this.enemies);\r\n    if (!enemy) { return }\r\n\r\n    enemy.goTo({ x: x, y: y })\r\n  }\r\n\r\n  stopAnimationLoop() {\r\n    for (let enemy of this.enemies.getChildren()) {\r\n      if (!(typeof enemy.lastMoveAt === \"undefined\") && enemy.lastMoveAt < this.game.getTime() - 200) {\r\n        enemy.anims.stop();\r\n      }\r\n    }\r\n  }\r\n\r\n  onShowBomb({ bomb_id, col, row }) {\r\n    this.bombs.add(new Bomb(this, bomb_id, col, row));\r\n  }\r\n\r\n  onDetonateBomb({ bomb_id, blastedCells }) {\r\n    // Remove Bomb:\r\n    findAndDestroyFrom(bomb_id, this.bombs)\r\n\r\n    // Render Blast:\r\n    for (let cell of blastedCells) {\r\n        this.blasts.add(new FireBlast(this, cell));\r\n    };\r\n\r\n    // Destroy Tiles:\r\n    for (let cell of blastedCells) {\r\n      if (!cell.destroyed) { continue }\r\n\r\n      this.blockLayer.putTileAt(this.blockLayer.layer.properties.empty, cell.col, cell.row);\r\n    };\r\n\r\n    // Add Spoils:\r\n    for (let cell of blastedCells) {\r\n      if (!cell.destroyed) { continue }\r\n      if (!cell.spoil) { continue }\r\n\r\n      this.spoils.add(new Spoil(this, cell.spoil));\r\n    };\r\n  }\r\n\r\n  onSpoilWasPicked({ player_id, spoil_id, spoil_type }){\r\n    if (player_id === this.player.id){\r\n      this.player.pickSpoil(spoil_type)\r\n    }\r\n\r\n    findAndDestroyFrom(spoil_id, this.spoils)\r\n  }\r\n\r\n  onShowBones({ player_id, col, row }) {\r\n    this.bones.add(new Bone(this, col, row));\r\n\r\n    findAndDestroyFrom(player_id, this.enemies)\r\n  }\r\n\r\n  onPlayerWin(winner_skin) {\r\n    this.socket.emit('leave game');\r\n\r\n    this.scene.start('Win',winner_skin);\r\n    console.log('ToDo: this.state.start Win: '+winner_skin);\r\n  }\r\n\r\n  onPlayerDisconnect({ player_id }) {\r\n    findAndDestroyFrom(player_id, this.enemies);\r\n\r\n    if (this.enemies.children.length >= 1) { return }\r\n\r\n    this.onPlayerWin()\r\n  }\r\n}\r\n\r\nexport default Play;\r\n","export class Preload extends Phaser.Scene {\r\n\r\n  constructor () {\r\n      super('Preload');\r\n  }\r\n\r\n  preload() {\r\n    // Menu:\r\n    this.load.image('main_menu',     'images/menu/main_menu.png');\r\n    this.load.image('slot_backdrop', 'images/menu/slot_backdrop.png');\r\n\r\n    this.load.spritesheet('buttons',    'images/menu/buttons.png',{ frameWidth: 200, frameHeight: 75 });\r\n    this.load.spritesheet('check_icon', 'images/menu/accepts.png', { frameWidth: 75, frameHeight: 75 });\r\n    this.load.spritesheet('list_icon',  'images/menu/game_enter.png', { frameWidth: 75, frameHeight: 75 });\r\n\r\n    this.load.image('hot_map_preview',  'images/menu/hot_map_preview.png');\r\n    this.load.image('cold_map_preview', 'images/menu/cold_map_preview.png');\r\n    this.load.image('hot_map_preview_mini',  'images/menu/hot_map_preview_mini.png');\r\n    this.load.image('cold_map_preview_mini', 'images/menu/cold_map_preview_mini.png');\r\n    this.load.image('prev',             'images/menu/left_arrow.png');\r\n    this.load.image('next',             'images/menu/right_arrow.png');\r\n\r\n    // Map:\r\n    this.load.image('tiles',      'maps/tileset.png');\r\n    this.load.tilemapTiledJSON('hot_map',  'maps/hot_map.json');\r\n    this.load.tilemapTiledJSON('cold_map', 'maps/cold_map.json');\r\n\r\n\r\n    // Game:\r\n    this.load.spritesheet('explosion_center',     'images/game/explosion_center.png',     { frameWidth: 35, frameHeight: 35});\r\n    this.load.spritesheet('explosion_horizontal', 'images/game/explosion_horizontal.png', { frameWidth: 35, frameHeight: 35});\r\n    this.load.spritesheet('explosion_vertical',   'images/game/explosion_vertical.png',   { frameWidth: 35, frameHeight: 35});\r\n    this.load.spritesheet('explosion_up',         'images/game/explosion_up.png',         { frameWidth: 35, frameHeight: 35});\r\n    this.load.spritesheet('explosion_right',      'images/game/explosion_right.png',      { frameWidth: 35, frameHeight: 35});\r\n    this.load.spritesheet('explosion_down',       'images/game/explosion_down.png',       { frameWidth: 35, frameHeight: 35});\r\n    this.load.spritesheet('explosion_left',       'images/game/explosion_left.png',       { frameWidth: 35, frameHeight: 35});\r\n\r\n    this.load.spritesheet('spoil_tileset', 'images/game/spoil_tileset.png', { frameWidth: 35, frameHeight: 35});\r\n    this.load.spritesheet('bone_tileset',  'images/game/bone_tileset.png', { frameWidth: 35, frameHeight: 35});\r\n    this.load.spritesheet('bomb_tileset',  'images/game/bombs.png', { frameWidth: 35, frameHeight: 35});\r\n\r\n    this.load.image('speed_up_bonus',    'images/game/speed_up_bonus.png');\r\n    this.load.image('speed_up_no_bonus', 'images/game/speed_up_no_bonus.png');\r\n    this.load.image('delay_up_bonus',    'images/game/delay_up_bonus.png');\r\n    this.load.image('delay_up_no_bonus', 'images/game/delay_up_no_bonus.png');\r\n    this.load.image('power_up_bonus',    'images/game/power_up_bonus.png');\r\n\r\n    this.load.image('placeholder_power', 'images/game/placeholder_power.png');\r\n    this.load.image('placeholder_speed', 'images/game/placeholder_speed.png');\r\n    this.load.image('placeholder_time',  'images/game/placeholder_time.png');\r\n\r\n    // Skins:\r\n    this.load.image('bomberman_head_blank',     'images/game/chars/0-face.png');\r\n\r\n    this.load.image('bomberman_head_Theodora',  'images/game/chars/1-face.png');\r\n    this.load.image('bomberman_head_Ringo',     'images/game/chars/2-face.png');\r\n    this.load.image('bomberman_head_Jeniffer',  'images/game/chars/3-face.png');\r\n    this.load.image('bomberman_head_Godard',    'images/game/chars/4-face.png');\r\n    this.load.image('bomberman_head_Biarid',    'images/game/chars/5-face.png');\r\n    this.load.image('bomberman_head_Solia',     'images/game/chars/6-face.png');\r\n    this.load.image('bomberman_head_Kedan',     'images/game/chars/7-face.png');\r\n    this.load.image('bomberman_head_Nigob',     'images/game/chars/8-face.png');\r\n    this.load.image('bomberman_head_Baradir',   'images/game/chars/9-face.png');\r\n    this.load.image('bomberman_head_Raviel',    'images/game/chars/10-face.png');\r\n    this.load.image('bomberman_head_Valpo',     'images/game/chars/11-face.png');\r\n\r\n    this.load.spritesheet('bomberman_Theodora',  'images/game/chars/1-preview.png', { frameWidth: 32, frameHeight: 32});\r\n    this.load.spritesheet('bomberman_Ringo',     'images/game/chars/2-preview.png', { frameWidth: 32, frameHeight: 32});\r\n    this.load.spritesheet('bomberman_Jeniffer',  'images/game/chars/3-preview.png', { frameWidth: 32, frameHeight: 32});\r\n    this.load.spritesheet('bomberman_Godard',    'images/game/chars/4-preview.png', { frameWidth: 32, frameHeight: 32});\r\n    this.load.spritesheet('bomberman_Biarid',    'images/game/chars/5-preview.png', { frameWidth: 32, frameHeight: 32});\r\n    this.load.spritesheet('bomberman_Solia',     'images/game/chars/6-preview.png', { frameWidth: 32, frameHeight: 32});\r\n    this.load.spritesheet('bomberman_Kedan',     'images/game/chars/7-preview.png', { frameWidth: 32, frameHeight: 32});\r\n    this.load.spritesheet('bomberman_Nigob',     'images/game/chars/8-preview.png', { frameWidth: 32, frameHeight: 32});\r\n    this.load.spritesheet('bomberman_Baradir',   'images/game/chars/9-preview.png', { frameWidth: 32, frameHeight: 32});\r\n    this.load.spritesheet('bomberman_Raviel',    'images/game/chars/10-preview.png', { frameWidth: 32, frameHeight: 32});\r\n    this.load.spritesheet('bomberman_Valpo',     'images/game/chars/11-preview.png', { frameWidth: 32, frameHeight: 32});\r\n\r\n    this.load.scenePlugin({\r\n      key: 'rexuiplugin',\r\n      url: 'https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/dist/rexuiplugin.min.js',\r\n      sceneKey: 'rexUI'\r\n    });   \r\n    \r\n  }\r\n\r\n  create() {\r\n    this.scene.start('Menu');\r\n  }\r\n}\r\n\r\nexport default Preload;\r\n","import { AVAILABLE_MAPS } from '../utils/constants.js';\r\nimport { Text, TextButton, MapSlider } from '../helpers/elements.js';\r\n\r\nconst COLOR_PRIMARY = 0x4e342e;\r\nconst COLOR_LIGHT = 0x7b5e57;\r\nconst COLOR_DARK = 0x260e04;\r\n\r\nclass SelectMap extends Phaser.Scene {\r\n\r\n  constructor () {\r\n    super('SelectMap');\r\n  }\r\n\r\n  preload() { \r\n    this.load.scenePlugin({\r\n        key: 'rexuiplugin',\r\n        url: 'https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/dist/rexuiplugin.min.js',\r\n        sceneKey: 'rexUI',\r\n        visible: false\r\n    });     \r\n  }\r\n\r\n  init() {\r\n    this.socket=this.registry.get('socketIO');\r\n  }\r\n\r\n  create() {\r\n\r\n\r\n    this.container = this.add.container(0, 0);\r\n    \r\n    var img= this.add.image(this.sys.canvas.clientWidth/2, this.sys.canvas.clientHeight/2, 'main_menu')\r\n      .setOrigin(0.5,0.5);\r\n\r\n    this.container.add(img);\r\n\r\n    var txt= new Text({\r\n      game: this,\r\n      x: this.sys.canvas.clientWidth/2,\r\n      y: this.sys.canvas.clientHeight/2 - 215,\r\n      text: 'Select Map',\r\n      style: {\r\n        font: '35px Areal',\r\n        fill: '#9ec0ba',\r\n        stroke: '#6f7975',\r\n        strokeThickness: 3\r\n      }\r\n    });\r\n\r\n    this.container.add(txt);\r\n\r\n    this.selectedMap='hot_map';\r\n\r\n    var button = new TextButton({\r\n      game: this,\r\n      x: this.sys.canvas.clientWidth/2,\r\n      y: this.sys.canvas.clientHeight/2 + 195,\r\n      asset:'check_icon',\r\n      callback: this.confirmStageSelection,\r\n      callbackContext: this,\r\n      upFrame: 0,\r\n      overFrame:1,\r\n      downFrame:2,\r\n      outFrame:3,\r\n      label: '',\r\n      style: {\r\n        font: '20px Areal',\r\n        fill: '#000000'\r\n      }\r\n    });\r\n \r\n    this.container.add(button);\r\n    \r\n    this.mapSlider = new MapSlider({\r\n      scene: this,\r\n      x: this.sys.canvas.clientWidth/2,\r\n      y: this.sys.canvas.clientHeight/2\r\n    });\r\n\r\n  }  \r\n\r\n  confirmStageSelection() {\r\n    if (!this.mapSlider.selected!=null)\r\n      this.selectedMap=this.mapSlider.selected;\r\n    this.socket.emit('create game', this.selectedMap, this.joinToNewGame.bind(this));\r\n  };\r\n\r\n  joinToNewGame(game_id) {\r\n    this.mapSlider.destroy();\r\n    this.scene.start('PendingGame', game_id);\r\n  };\r\n\r\n  update() {}\r\n\r\n}\r\n\r\nexport default SelectMap;\r\n","import { Text,TextButton } from '../helpers/elements.js';\r\n\r\nclass Win extends Phaser.Scene {\r\n\r\n  constructor () {\r\n    super('Win');\r\n  }\r\n\r\n  init(winner_skin) {\r\n    this.skin = winner_skin\r\n  }\r\n\r\n  create() {\r\n    new Text({\r\n      game: this,\r\n      x: this.sys.canvas.clientWidth/2,\r\n      y: this.sys.canvas.clientHeight/2,\r\n      text: this.winnerText(),\r\n      style: {\r\n        font: '30px Areal',\r\n        fill: '#FFFFFF'\r\n      }\r\n    })\r\n\r\n    this.button = new TextButton({\r\n      game: this,\r\n      x: this.sys.canvas.clientWidth/2,\r\n      y: this.sys.canvas.clientHeight/2 + 195,\r\n      asset:'buttons',\r\n      callback: this.returnToMenu,\r\n      callbackContext: this,\r\n      upFrame: 0,\r\n      overFrame:1,\r\n      downFrame:2,\r\n      outFrame:3,\r\n      label: 'Back to Menu',\r\n      style: {\r\n        font: '20px Areal',\r\n        fill: '#000000'\r\n      }\r\n    });\r\n    this.cursorKeys  = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ENTER);\r\n  }\r\n\r\n  update() {\r\n    if( this.cursorKeys.isDown ) {\r\n      this.returnToMenu();\r\n    }\r\n  }\r\n\r\n  returnToMenu() {\r\n    this.scene.start('Menu');\r\n  }\r\n\r\n  winnerText() {\r\n    if (this.skin) {\r\n      return 'Player: \"'+this.skin+'\" won! Press Enter to return to main menu.';\r\n    }\r\n    return 'Opponent left! Press Enter to return to main menu.'\r\n  }\r\n}\r\n\r\nexport default Win;\r\n","export const AVAILABLE_MAPS = ['hot_map', 'cold_map']\r\nexport const TILESET = 'tiles';\r\nexport const LAYER   = 'Blocks';\r\n\r\nexport const TILE_SIZE = 35;\r\nexport const EXPLOSION_TIME = 2000;\r\nexport const PING = 100;\r\n\r\nexport const SPEED = 0;\r\nexport const POWER = 1;\r\nexport const DELAY = 2;\r\n\r\nexport const INITIAL_SPEED = 150;\r\nexport const STEP_SPEED = 50;\r\nexport const MAX_SPEED = 350;\r\nexport const INITIAL_DELAY = 2000;\r\nexport const STEP_DELAY = 500;\r\nexport const MIN_DELAY = 500;\r\nexport const INITIAL_POWER = 1;\r\nexport const STEP_POWER = 1;\r\n","export const findFrom = function(id, entities) {\r\n  for (let entity of entities.getChildren()) {\r\n    if (entity.id !== id) { continue }\r\n\r\n    return entity\r\n  }\r\n  return null;\r\n}\r\n\r\nexport const findAndDestroyFrom = function(id, entities) {\r\n  let entity = findFrom(id, entities);\r\n  if (!entity) { return }\r\n\r\n  entity.destroy()\r\n}\r\n"],"sourceRoot":""}